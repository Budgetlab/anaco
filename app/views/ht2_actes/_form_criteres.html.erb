<h2>Contrôle des critères </h2>
<div data-controller="acte-form">
  <%= form_with(model: @acte) do |f| %>
    <%= hidden_field_tag :etape, 3 %>
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-12">
        <div class="fr-checkbox-group fr-mb-2w">
          <%= f.check_box :programmation_prevue, id: "programmation_prevue" %>
          <label class="fr-label" for="programmation_prevue">L’acte figurait dans le dernier document de programmation.</label>
        </div>
      </div>
    </div>
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-6">
        <h6 class="fr-my-1w">1. Disponibilité des
          crédits <%= render partial: "ht2_actes/tooltip", locals: { name: "disponibilite_credits" } %></h6>
        <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
            Le critère est-il validé ?*
          </legend>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :disponibilite_credits, true, id: "radio-true-1", checked: @acte.disponibilite_credits.nil? || @acte.disponibilite_credits == true %>
              <label class="fr-label" for="radio-true-1">Oui</label>
            </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :disponibilite_credits, false, checked: @acte.disponibilite_credits == false, id: "radio-false-1" %>
              <label class="fr-label" for="radio-false-1">Non</label>
            </div>
          </div>
        </fieldset>
      </div>
      <div class="fr-col-12 fr-col-lg-6">
        <h6 class="fr-my-1w">2. Imputation de la dépense
          <% if @acte.type_acte == 'TF' %><%= render partial: "ht2_actes/tooltip", locals: { name: "imputation_depense_tf" } %>
          <% else %><%= render partial: "ht2_actes/tooltip", locals: { name: "imputation_depense" } %>
          <% end %></h6>
        <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
            Le critère est-il validé ?*
          </legend>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :imputation_depense, true, id: "radio-true-2", checked: @acte.imputation_depense.nil? || @acte.imputation_depense == true %>
              <label class="fr-label" for="radio-true-2">Oui</label>
            </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :imputation_depense, false, checked: @acte.imputation_depense == false, id: "radio-false-2" %>
              <label class="fr-label" for="radio-false-2">Non</label>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-6">
        <h6 class="fr-my-1w">3. Exactitude de l'évaluation de la consommation des
          crédits <%= render partial: "ht2_actes/tooltip", locals: { name: "consommation_credits" } %></h6>
        <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
            Le critère est-il validé ?*
          </legend>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :consommation_credits, true, id: "radio-true-3", checked: @acte.consommation_credits.nil? || @acte.consommation_credits == true %>
              <label class="fr-label" for="radio-true-3">Oui</label>
            </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :consommation_credits, false, checked: @acte.consommation_credits == false, id: "radio-false-3" %>
              <label class="fr-label" for="radio-false-3">Non</label>
            </div>
          </div>
        </fieldset>
      </div>
      <div class="fr-col-12 fr-col-lg-6">
        <h6 class="fr-my-1w">4. Compatibilité avec la programmation annuelle et
          pluri-annuelle <%= render partial: "ht2_actes/tooltip", locals: { name: "programmation" } %></h6>
        <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
            Le critère est-il validé ?*
          </legend>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :programmation, true, id: "radio-true-4", checked: @acte.programmation.nil? || @acte.programmation == true%>
              <label class="fr-label" for="radio-true-4">Oui</label>
            </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
            <div class="fr-radio-group">
              <%= f.radio_button :programmation, false, checked: @acte.programmation == false, id: "radio-false-4" %>
              <label class="fr-label" for="radio-false-4">Non</label>
            </div>
          </div>
        </fieldset>
      </div>
    </div>
    <div class="mt-4">
      <label class="form-label">Tableur</label>

      <%= f.hidden_field :sheet_data, id: dom_id(@acte, :sheet_data) %>

      <div
        data-controller="sheet"
        data-sheet-input-id-value="<%= dom_id(@acte, :sheet_data) %>"
        data-sheet-initial-value='<%= (@acte.sheet_data || { data: [] }).to_json %>'
        data-sheet-min-cols-value="6"
        data-sheet-min-rows-value="10"
      ></div>

      <p class="fr-hint-text mt-2">
        Clique droit pour insérer/supprimer des lignes/colonnes.
      </p>
    </div>

    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-12">
        <div class="fr-input-group" data-controller="trix">
          <label for="commentaire_disponibilite_credits" class="fr-label">Observations
            <span class="fr-hint-text">Pour les pièces jointes, seules les images, captures d'écran sont autorisées. Taille maximale autorisée par fichier: 1Mo</span>
          </label>
          <%= f.rich_text_area :commentaire_disponibilite_credits, direct_upload: true, class: 'trix-content-form' %>
        </div>
      </div>
    </div>
    <div class="fr-grid-row fr-grid-row--gutters">
      <div class="fr-col-12 fr-col-lg-12 fr-my-2w">
        <ul class="fr-btns-group fr-btns-group--icon-left fr-btns-group--inline fr-btns-group--right">
          <li><%= f.submit "Enregistrer et continuer", class: 'fr-btn' %></li>
        </ul>
      </div>
    </div>
  <% end %>
</div>