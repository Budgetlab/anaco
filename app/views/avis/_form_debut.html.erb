<div class="fr-container" data-controller="form">
  <div class="fr-grid-row fr-grid-row--gutters">
    <div class="fr-col-12 fr-col-lg-12">
      <h1 class="fr-mt-6w">Formulaire début de gestion 2023</h1>
      <div class="fr-h3 fr-mb-4w">BOP n°<%= @bop.code%></div>
    </div>
  </div>

  
    <%= form_with(url: avis_path, method: :post, data: {'form-target': "form", action: "change->form#formChange input->form#formChange"}) do |f|%>
    <div class="fr-grid-row fr-grid-row--gutters fr-mb-4w">
    <div class="fr-col-12 fr-col-lg-4">
      <div class="fr-select-group">
        <label for="datereception" class="fr-label">Date de réception BOP initial*
          <span class="fr-hint-text">Indiquer ici la date de réception des documents finalisés</span>
        </label>
        <%= f.text_field :date_reception, {data: { 'form-target': 'datereception',action: "change->form#changeDate1", controller: "flatpickr",flatpickr_date_format: "d-m-Y",flatpickr_min_date: Date.new(Date.today.year,1,1), flatpickr_max_date: Date.new(Date.today.year,12,31)}, id: "datereception",class:"fr-select", placeholder: "- sélectionner -"} %>
        <p class="fr-message fr-message--info fr-hidden" data-form-target="datealerte1"></p>
      </div>
      <div class="fr-select-group">
        <label for="dateenvoi" class="fr-label">Date de réception BOP initial*
        <span class="fr-hint-text">Indiquer ici la date du courrier de l’envoi de l’avis</span></label>
        <%= f.text_field :date_envoi, {data: { 'form-target': 'dateenvoi',action: "change->form#changeDate2", controller: "flatpickr",flatpickr_date_format: "d-m-Y",flatpickr_min_date: Date.new(Date.today.year,1,1), flatpickr_max_date: Date.new(Date.today.year,12,31)}, id: "dateenvoi",class:"fr-select", placeholder: "- sélectionner -"} %>
        <p class="fr-message fr-message--info fr-hidden" data-form-target="datealerte2"></p>
      </div>

      <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
              Avis donné après interruption du délai*
          </legend>
          
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                  <%= f.radio_button :is_delai, true, id: "radio-delai1", checked: false  %>
                  <label class="fr-label" for="radio-delai1">Oui</label>
              </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                  <%= f.radio_button :is_delai, false, checked: true, id:"radio-delai" %>
                  <label class="fr-label" for="radio-delai">Non</label>
              </div>
          </div>
          
      </fieldset>

      <fieldset class="fr-fieldset fr-mb-3w">
          <legend class="fr-fieldset__legend--regular fr-fieldset__legend fr-mb-1w" id='radio-inline-legend'>
              CRG1 programmé*
          </legend>
          
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                  <%= f.radio_button :is_crg1, true, id: "radio-crg11", checked: false  %>
                  <label class="fr-label" for="radio-crg11">Oui</label>
              </div>
          </div>
          <div class="fr-fieldset__element fr-fieldset__element--inline fr-mb-0">
              <div class="fr-radio-group">
                  <%= f.radio_button :is_crg1, false, checked: true, id:"radio-crg1" %>
                  <label class="fr-label" for="radio-crg1">Non</label>
              </div>
          </div>
          
      </fieldset>

      <div class="fr-select-group">
          <label for="statut" class="fr-label">Sens de l'avis*</label>
          <%= f.select :statut,[['Favorable','Favorable'],['Favorable avec réserve','Favorable avec réserve'],['Défavorable','Défavorable'],],{prompt: "- sélectionner -"}, {data: {'form-target': 'statut' }, id:"statut",class:"fr-select"}%>
      </div>  
    </div>
    <div class="fr-col-12 fr-col-lg-8">
      <div class="fr-accordion__title">Ressources allouées initiales 2023</div>
      <hr class="fr-col_12">
      <div class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="aei">
                AE HT2 initial 2023*
            </label>
            <%= f.number_field :ae_i, data: {'form-target': 'aei' }, class:"fr-input", id:"aei" %>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="cpi">
                CP HT2 initial 2023*
            </label>
            <%= f.number_field :cp_i,  data: {'form-target': 'cpi' }, class:"fr-input", id:"cpi"%>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="t2i">
                AE/CP T2 initial 2023* 
            </label>
            <%= f.number_field :t2_i,  data: {'form-target': 't2i' }, class:"fr-input", id:"t2i"%>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="etpti">
                ETPT initial 2023*
            </label>
            <%= f.number_field :etpt_i, data: {'form-target': 'etpti' }, class:"fr-input", id:"etpti"%>
          </div>
        </div>
      </div>
      <div class="fr-accordion__title fr-mt-3w">Prévisions de consommation à fin décembre</div>
      <hr class="fr-col_12">
      <div class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="aef">
                AE HT2 final 2023*
            </label>
            <%= f.number_field :ae_f, data: {'form-target': 'aef' }, class:"fr-input", id:"aef"%>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="cpf">
                CP HT2 final 2023*
            </label>
            <%= f.number_field :cp_f, data: {'form-target': 'cpf' }, class:"fr-input", id:"cpf"%>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="t2i">
                AE/CP T2 final 2023* 
            </label>
            <%= f.number_field :t2_f, data: {'form-target': 't2f' },class:"fr-input", id:"t2f"%>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-input-group">
            <label class="fr-label" for="etptf">
                ETPT final 2023*
            </label>
            <%= f.number_field :etpt_f, data: {'form-target': 'etptf' },class:"fr-input", id:"etptf"%>
          </div>
        </div>
      </div>
      <div class="fr-accordion__title fr-mt-3w">Ecarts ressources/prévisions d’exécution 2023</div>
      <hr class="fr-col_12">
      <div class="fr-grid-row fr-grid-row--gutters">
        <div class="fr-col-3">
          <div class="fr-card fr-card--blue fr-p-2w fr-card--no-border">
            <div class="fr-cart__body">
              <p class="fr-text--lg fr-mb-0 text_center">AE HT2</p>
              <p class="fr-text--lg fr-text--bold fr-mb-0 text_center" data-form-target="aeresult">-</p>
            </div>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-card fr-card--blue fr-p-2w fr-card--no-border">
            <div class="fr-cart__body">
              <p class="fr-text--lg fr-mb-0 text_center">CP HT2</p>
              <p class="fr-text--lg fr-text--bold fr-mb-0 text_center" data-form-target="cpresult">-</p>
            </div>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-card fr-card--blue fr-p-2w fr-card--no-border">
            <div class="fr-cart__body">
              <p class="fr-text--lg fr-mb-0 text_center">AE/CP T2</p>
              <p class="fr-text--lg fr-text--bold fr-mb-0 text_center" data-form-target="t2result">-</p>
            </div>
          </div>
        </div>
        <div class="fr-col-3">
          <div class="fr-card fr-card--blue fr-p-2w fr-card--no-border">
            <div class="fr-cart__body">
              <p class="fr-text--lg fr-mb-0 text_center">ETPT</p>
              <p class="fr-text--lg fr-text--bold fr-mb-0 text_center" data-form-target="etptresult">-</p>
            </div>
          </div>
        </div>
      </div>
      <div class="fr-input-group fr-mt-3w">
        <label class="fr-label" for="commentaire">
            Développements synthétiques sur l’avis (destinés à un usage interne)*
            <span class="fr-hint-text">800 caractères recommandés, espaces compris</span>
        </label>
        <%= f.text_area :commentaire, data: {'form-target': 'commentaire', action: "input->form#count" }, class:"fr-input", id:"commentaire", rows: 10%>
        <p class="fr-message fr-message--info" data-form-target="count"> caractères</p>
      </div>

      <ul class="fr-btns-group fr-btns-group--inline fr-btns-group--right">
        <li>
          <button data-action="form#save" data-form-target="Btnsave" class="fr-btn fr-icon-save-3-fill fr-btn--icon-left fr-btn--secondary" title="Enregistrer"> Enregistrer</button>
        </li>
        <li>
          <button data-action="form#save" data-form-target="Btnvalidate" class="fr-btn bouton_inactive" title="Valider"> Valider</button>
          <%= f.submit "Valider", class: "fr-btn fr-hidden", data: {'form-target': "submitBouton"}, aria: { label: "Valider"} %>                 
        </li>
      </ul>
    </div>
    </div>
    <% end %>
  
</div>
